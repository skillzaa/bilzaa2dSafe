class PlayHead{constructor(){this.duration=1e5,this.oldTime=0,this.paused=!0,this.startTime=0}runningTime(){if(!1!==this.paused)return this.oldTime/1e3;var t=Date.now()-this.startTime;return Number((t/1e3).toFixed(2))}play(){!0===this.paused&&(this.startTime=Date.now()-this.oldTime,this.oldTime=0,this.paused=!1)}pause(){!1===this.paused&&(this.oldTime=Date.now()-this.startTime,this.startTime=0,this.paused=!0)}stop(){this.oldTime=0,this.startTime=0,this.paused=!0}resume(){this.play()}forward(t=5e3){let e=!1;!0===this.paused&&(e=!0),this.pause(),this.oldTime+t<this.duration&&(this.oldTime=this.oldTime+t),0==e&&this.play()}rewind(t=5e3){let e=!1;!0===this.paused&&(e=!0),this.pause(),0<this.oldTime-t&&(this.oldTime=this.oldTime-t),0==e&&this.play()}}class Metal{constructor(){this.load()}load(t="bilzaaCanvas"){try{this.canvas=document.getElementById(t),this.ctx=this.canvas.getContext("2d"),this.ctx.canvas.width=window.innerWidth,this.ctx.canvas.height=window.innerHeight}catch(t){return!1}}clear(){this.ctx.fillStyle="#f5ecc3",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}clearCanvas(t="#e9f7f2"){this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}drawRectangleBorder(t){this.ctx.save(),this.ctx.beginPath(),this.ctx.globalAlpha=t.getProperty("opacity"),this.ctx.lineWidth=t.getProperty("borderWidth"),this.ctx.lineJoin="round",this.ctx.strokeStyle=t.getProperty("borderColor"),!0===t.getProperty("dashedBorder")&&this.ctx.setLineDash([t.getProperty("dashSize"),t.getProperty("gapBetweenDashes")]),this.ctx.rect(t.getProperty("x")-t.getProperty("borderWidth")/2,t.getProperty("y")-t.getProperty("borderWidth")/2,t.getProperty("width")+t.getProperty("borderWidth"),t.getProperty("height")+t.getProperty("borderWidth")),this.ctx.stroke(),this.ctx.restore()}saveCtx(){this.ctx.save()}restoreCtx(){this.ctx.restore()}drawRectangle(t){this.ctx.save(),this.ctx.globalAlpha=t.getProperty("opacity"),this.ctx.fillRect(t.getProperty("x"),t.getProperty("y"),t.getProperty("width"),t.getProperty("height")),this.ctx.restore()}drawCircle(t){this.ctx.beginPath(),this.ctx.arc(t.getProperty("x"),t.getProperty("y"),t.getProperty("radius"),0,2*Math.PI),this.ctx.stroke()}drawTriangle(t){this.ctx.save(),this.ctx.fillStyle=t.getProperty("color"),this.ctx.beginPath(),this.ctx.moveTo(t.getProperty("x"),t.getProperty("y")+t.getProperty("height")),this.ctx.lineTo(t.getProperty("x")+t.getProperty("width"),t.getProperty("y")+t.getProperty("height")),this.ctx.lineTo(t.getProperty("x")+t.getProperty("width")/2,t.getProperty("y")),this.ctx.fill(),this.ctx.restore()}drawRectangleTitle(t){this.ctx.save(),this.ctx.globalAlpha=t.getProperty("titleOpacity"),this.ctx.fillStyle=t.getProperty("titleColor"),this.ctx.font=`${t.getProperty("titleFontSize")}px ${t.getProperty("titleFontFamily")}`;var e=this.ctx.measureText("M").width,a=this.ctx.measureText(t.getProperty("title")).width,a=t.getProperty("x")+t.getProperty("width")/2-a/2,e=t.getProperty("y")+t.getProperty("height")/2+e/2;this.ctx.fillText(t.getProperty("title"),a,e),this.ctx.restore()}drawText(t){this.ctx.save(),this.ctx.fillStyle=t.getProperty("color"),this.ctx.font=`${t.getProperty("fontSize")}px ${t.getProperty("fontFamily")}`,this.ctx.fillText(t.getProperty("title"),t.getProperty("x"),t.getProperty("y")),this.ctx.restore()}getCtxValues(t){this.ctx.fillStyle=t.getItem("color").value,this.ctx.strokeStyle=t.getItem("strokeColor").value,this.ctx.shadowColor=t.getItem("shadowColor").value,this.ctx.shadowBlur=t.getItem("shadowBlur").value,this.ctx.shadowOffsetX=t.getItem("shadowOffsetX").value,this.ctx.shadowOffsetY=t.getItem("shadowOffsetY").value}translateCanvas(t){this.ctx.translate(t.getItem("x").value+t.getItem("width").value/2,t.getItem("y").value+t.getItem("height").value/2)}unTranslateCanvas(t){this.ctx.translate(-(t.getItem("x").value+t.getItem("width").value/2),-(t.getItem("y").value+t.getItem("height").value/2))}rotateCanvas(t){this.ctx.rotate(t.getItem("currentRotateAngle").value*Math.PI/180)}drawEllipse(){this.ctx.ellipse(100,100,50,75,45*Math.PI/180,0,2*Math.PI)}}class ArrayOfObjects{constructor(){this.data=[]}add(t={}){return this.data.push(t),t}isUnique(e){if(void 0===e)return!1;let a=!0;for(let t=0;t<this.data.length;t++)this.data[t].name===e&&(a=!1);return a}get length(){return this.data.length}getItem(e){for(let t=0;t<this.data.length;t++)if(this.data[t].name===e)return this.data[t];return!1}getProperty(e,a="value"){for(let t=0;t<this.data.length;t++)if(this.data[t].name===e)return this.data[t][a];return!1}setProperty(e,a,s="value"){for(let t=0;t<this.data.length;t++)if(this.data[t].name===e)return this.data[t][s]=a,this.data[t];return!0}getAllByNames(t=[]){const a=[];return this.data.forEach(e=>{t.forEach(t=>{t==e.name&&a.push(e)})}),a}insertPropertiesFromArray(t){return this.data.forEach(e=>{t.forEach(t=>{t.name==e.name&&(e.value=t.value)})}),!0}setAllProperties(t,e){}getItemsByNames(t=[]){const a=[];return this.data.forEach(e=>{t.forEach(t=>{t==e.name&&a.push(e)})}),a}}class Animation{constructor(t,e={}){this.attributeToAnimateName=t.attributeToAnimateName,this.fromSecond=t.fromSecond,this.toSecond=t.toSecond,this.readOnlyElementAttrNames=t.readOnlyElementAttrNames,this.argsForAlgo=e,this.fps=60,this.lastExecutionTime=0,this.store={}}animate(t,e,a=0){return!0}}class Linear extends Animation{constructor(t,e={}){super(t,e)}animate(t,e,a){return e<this.fromSecond||e>this.toSecond?t:(t=this.deltaPerSecond()*this.currentTimeDifference(e)+this.fromSecond,Number(t))}deltaPerFrame(){const t=this.deltaPerSecond()/this.fps;return t.toFixed(2)}deltaPerSecond(){var t=this.toSecond-this.fromSecond;const e=(this.argsForAlgo.to-this.argsForAlgo.from)/t;return e.toFixed(2)}currentTimeDifference(t){t=(t-this.fromSecond).toFixed(2);return Number(t)}}class AnimationsFasade{constructor(){this.data=[]}linear(t,e={}){e=new Linear(t,e);return this.data.push(e),!0}moveHorizontal(t=1,e=5,a=1,s=100){s=new Linear({attributeToAnimateName:"x",fromSecond:t,toSecond:e,readOnlyElementAttrNames:[]},{from:a,to:s});return this.data.push(s),!0}moveVerticle(t=1,e=5,a=1,s=100){s=new Linear({attributeToAnimateName:"y",fromSecond:t,toSecond:e,readOnlyElementAttrNames:[]},{from:a,to:s});return this.data.push(s),!0}moveDiagonal(t=1,e=5,a=1,s=100,r=1,i=100){s=new Linear({attributeToAnimateName:"x",fromSecond:t,toSecond:e,readOnlyElementAttrNames:[]},{from:a,to:s});this.data.push(s);i=new Linear({attributeToAnimateName:"y",fromSecond:t,toSecond:e,readOnlyElementAttrNames:[]},{from:r,to:i});return this.data.push(i),!0}scale(t,e,a,s,r,i){s=new Linear({attributeToAnimateName:"width",fromSecond:t,toSecond:e,readOnlyElementAttrNames:[]},{from:a,to:s});this.data.push(s);i=new Linear({attributeToAnimateName:"height",fromSecond:t,toSecond:e,readOnlyElementAttrNames:[]},{from:r,to:i});return this.data.push(i),!0}rotate(t=1,e=5,a=1,s=100){s=new Linear({attributeToAnimateName:"currentRotateAngle",fromSecond:t,toSecond:e,readOnlyElementAttrNames:[]},{from:a,to:s});return this.data.push(s),s}}class Shape{constructor(t=0){this.attributes=new ArrayOfObjects,this.attributes.add({name:"name",value:0}),this.attributes.add({name:"x",value:100}),this.attributes.add({name:"y",value:100}),this.attributes.add({name:"width",value:100}),this.attributes.add({name:"height",value:50}),this.attributes.add({name:"rotateClockwise",value:!0}),this.attributes.add({name:"currentRotateAngle",value:0}),this.attributes.add({name:"color",value:"green"}),this.attributes.add({name:"opacity",value:1}),this.attributes.add({name:"strokeStyle",value:"#F0000"}),this.attributes.add({name:"shadowColor",value:"grey"}),this.attributes.add({name:"shadowBlur",value:10}),this.attributes.add({name:"shadowOffsetX",value:50}),this.attributes.add({name:"shadowOffsetY",value:50}),this.animations=new AnimationsFasade,this.metal=new Metal}preUpdate(){}postUpdate(){}update(s){return this.animations.data.forEach(t=>{var e,a;s>=t.fromSecond&&s<=t.toSecond&&(e=this.attributes.getItem(t.attributeToAnimateName).value,a=this.attributes.getItemsByNames(t.readOnlyElementAttrNames),a=t.animate(e,s,a),this.attributes.setProperty(t.attributeToAnimateName,a))}),!0}preDraw(){}draw(){}postDraw(){}setAttr(t,e){return this.attributes.setProperty(t,e)}getAttr(t){return this.attributes.getProperty(t)}}class Rectangle extends Shape{constructor(){super("rectangle")}draw(){this.metal.saveCtx(),this.metal.getCtxValues(this.attributes),this.metal.translateCanvas(this.attributes),this.metal.rotateCanvas(this.attributes),this.metal.unTranslateCanvas(this.attributes),!1===this.attributes.getProperty("transparent")&&this.metal.drawRectangle(this.attributes),this.metal.restoreCtx()}}class Triangle extends Shape{constructor(){super("triangle")}draw(){this.metal.saveCtx(),this.metal.getCtxValues(this.attributes),this.metal.translateCanvas(this.attributes),this.metal.rotateCanvas(this.attributes),this.metal.unTranslateCanvas(this.attributes),!1===this.attributes.getProperty("transparent")&&this.metal.drawTriangle(this.attributes),this.metal.restoreCtx()}}class AnimationsCircleFasade extends AnimationsFasade{constructor(){super()}scale(t,e,a,s){s=new Linear({attributeToAnimateName:"radius",fromSecond:t,toSecond:e,readOnlyElementAttrNames:[]},{from:a,to:s});return this.data.push(s),!0}rotate(){}}class Circle extends Shape{constructor(){super("circle"),this.animations=new AnimationsCircleFasade,this.attributes.add({name:"radius",value:300,comments:""})}draw(){this.metal.saveCtx(),this.metal.getCtxValues(this.attributes),this.metal.translateCanvas(this.attributes),this.metal.rotateCanvas(this.attributes),this.metal.unTranslateCanvas(this.attributes),this.metal.drawCircle(this.attributes),this.metal.restoreCtx()}}class AnimationsTextFasade extends AnimationsFasade{constructor(){super()}scale(t,e,a,s){s=new Linear({attributeToAnimateName:"fontSize",fromSecond:t,toSecond:e,readOnlyElementAttrNames:[]},{from:a,to:s});return this.data.push(s),!0}}class Text extends Shape{constructor(){super("text"),this.animations=new AnimationsTextFasade,this.attributes.add({name:"title",value:"Text"}),this.attributes.add({name:"color",value:"red"}),this.attributes.add({name:"fontSize",value:22}),this.attributes.add({name:"fontFamily",value:"Arial"})}draw(){this.metal.saveCtx(),this.metal.getCtxValues(this.attributes),this.metal.translateCanvas(this.attributes),this.metal.rotateCanvas(this.attributes),this.metal.unTranslateCanvas(this.attributes),this.metal.drawText(this.attributes),this.metal.restoreCtx()}}class Canvas extends Shape{constructor(){super("canvas"),this.attributes.add({name:"clearCanvasFlag",value:1})}draw(){1===this.attributes.getProperty("clearCanvasFlag")&&this.metal.clearCanvas()}}class Shapes{constructor(){this.data=[]}addRectangle(){var t=new Rectangle;return this.data.push(t),t}addCanvas(){var t=new Canvas;return this.data.push(t),t}addTriangle(){var t=new Triangle;return this.data.push(t),t}addCircle(){var t=new Circle;return this.data.push(t),t}addText(){var t=new Text;return this.data.push(t),t}}class Bilzaa2d{constructor(){this.playHead=new PlayHead,this.shapes=new Shapes}play(){this.playHead.play(),this.gameLoop()}gameLoop(){try{if(this.shapes.data.length<1)return;this.shapes.data[0].clearCanvasFlag=!0,this.shapes.data.forEach(t=>{var e=this.playHead.runningTime();t.preUpdate(),t.update(e),t.postUpdate(),t.preDraw(),t.draw(),t.postDraw()}),window.requestAnimationFrame(this.gameLoop.bind(this))}catch(t){return window.requestAnimationFrame(this.gameLoop.bind(this)),!0}}drawShapes(){this.shapes.data.forEach(t=>{t.draw()})}}export default Bilzaa2d;